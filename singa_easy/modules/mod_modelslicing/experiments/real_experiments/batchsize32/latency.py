import random

import matplotlib.pyplot as plt
from matplotlib.patches import Polygon
import matplotlib.pyplot as plt
import numpy as np



def drawBasic(tlist, x, slicerate):

     y = []
     label = []
     pots = []

     a = [124.31158447265625, 203.16515445709229, 310.9576663970947, 450.53621673583984, 621.2888326644897,
          731.969087600708, 960.1615929603577, 1061.1341099739075, 1139.1594219207764, 1310.9951968193054,
          1565.6969828605652, 1789.3355627059937, 2063.7728776931763, 2348.4308891296387, 2462.5417914390564,
          2513.197693824768, 2769.3452463150024, 2981.6282501220703, 3902.8323917388916, 4398.781165122986,
          5041.158689022064, 5793.761365890503, 6326.059074878693, 8024.716204166412, 8654.509522914886,
          9363.6529006958, 10433.818276882172, 10917.248187065125, 11762.185698509216]
     b = [196.02313232421875, 285.11769676208496, 372.11191177368164, 664.3046741485596, 861.7104034423828,
          1082.004033088684, 1312.783239364624, 1478.3067741394043, 1710.1743307113647, 1832.019100189209,
          2207.9928064346313, 2713.34250831604, 3165.790138244629, 3359.4494943618774, 3522.7454710006714,
          3724.051692008972, 3957.7420721054077, 4274.56157207489, 5376.906653404236, 6424.525240898132,
          7214.745351791382, 8402.489623069763, 9213.402135848999, 11350.080264091492, 12352.073260307312,
          13343.076992988586, 14580.297290802002, 15554.059559822083, 16397.67434310913]
     c = [294.4361877441406, 386.6520576477051, 611.3998031616211, 1021.4006996154785, 1379.8690795898438,
          1682.1387281417847, 2000.9823246002197, 2319.6549158096313, 2470.277070045471, 2902.038266181946,
          3507.6389589309692, 4106.179811477661, 4687.202833175659, 5071.19552898407, 5397.0515241622925,
          5720.07350063324, 5730.023384094238, 6592.725509643555, 7986.451503753662, 9539.764899253845,
          10820.478433609009, 12351.049160003662, 13952.404960632324, 17348.962842941284, 18623.455839157104,
          20835.402896881104, 21433.26817035675, 22425.29990005493, 24966.718008995056]
     d = [430.4192199707031, 550.373851776123, 772.5707054138184, 1431.702350616455, 1834.023639678955,
          2172.8227195739746, 2578.812442779541, 2917.9553813934326, 3516.9503650665283, 3777.178653717041,
          4424.531524658203, 5160.32364654541, 6062.862844467163, 6542.977722167969, 7096.093059539795,
          7140.271553039551, 7507.379867553711, 8217.52853012085, 10729.952939987183, 12153.294528961182,
          14328.955055236816, 16911.212450027466, 18909.59552383423, 22091.98244857788, 23558.03853416443,
          25640.750759124756, 28758.389184951782, 29453.856212615967, 32920.423027038574]
     y.append(d)
     y.append(c)
     y.append(b)
     y.append(a)

     for k in range(len(tlist)):

          label.append('sub-model with $r_i$ = ' + str(slicerate[k]) + ", $t_i=$" + str(tlist[k]) + "$s$")

          tmp = []
          for i in range(len(x)):
               tmp.append([x[i], y[k][i]])
          pots.append(tmp)

     return y, label, pots

import numpy


x = [1, 5, 10, 20, 30, 40, 50, 60, 70, 80, 100, 120, 140, 150, 160, 170, 180, 200, 250, 300, 350, 400, 450, 550, 600, 650, 700, 750, 800]
x = numpy.array(x)
x = [ele*32 for ele in x]
y, label, pots = drawBasic([0.0126, 0.0071, 0.00315, 0.00079], x, [1, 0.75, 0.5, 0.25])


fig=plt.figure(figsize=(10, 10))
ax=fig.add_subplot(111)
ax.axis([0, 800*32, 0, 35])

line_sym = ["-", "--", "-.", "-"]
pot_sym = ["o", ">", "<", "x"]
colors = ['blue', 'brown', 'aqua', 'green']
for i in range(len(y)):
     y_i = [ele/1000-0.01 for ele in y[i]]
     ax.plot(x, y_i, line_sym[i], marker=pot_sym[i], ms=10, label=label[i], linewidth=2,  color=colors[i])


# ysch_ = [0.0126, 0.63, 0.997, 0.996, 0.996, 0.99735, 0.9963500000000001, 0.99804, 0.99916, 0.99792, 0.99904, 0.9978, 0.99892, 0.9988, 0.99992, 1.027, 1.264, 1.343, 1.501, 1.6589999999999998, 1.817, 1.975, 2.0540000000000003, 2.133, 2.2119999999999997, 2.291, 2.37, 2.449, 2.528, 2.607, 2.686, 3.0810000000000004, 3.16]
# ysh = [ele-0.01 if (ele<1200) else ele for ele in ysch_]
# ax.plot(x, ysh,"--", marker='*', ms=10, label="combine of sub-models", linewidth=2)

plt.hlines(1.01, 0, 4500, label="deadline constrain=1s", linewidth=4, color="red")
#
plt.legend(fontsize=15)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)
ax.set_xlabel('Ingesting rate(#examples/second)', fontsize=20)
ax.set_ylabel('Latency(second)', fontsize=20)
plt.grid(linestyle='-.')
plt.savefig('./latency.jpg')
plt.show()








